# **Чистые функции (Pure Functions) в JavaScript**

Чистая функция — это функция, которая соответствует двум ключевым критериям:

### 1️⃣ **Детерминированность**
- **Всегда возвращает один и тот же результат** для одних и тех же входных данных.
- Не зависит от изменяемых внешних состояний.

### 2️⃣ **Отсутствие побочных эффектов (Side Effects)**
- Не изменяет внешние состояния (глобальные переменные, DOM, файловую систему и т. д.).
- Не мутирует входные данные.

---

## 🔹 **Пример чистой функции**
```javascript
function add(a, b) {
  return a + b;
}

console.log(add(2, 3)); // Всегда 5
```
✅ **Почему чистая?**  
- Результат зависит только от аргументов.  
- Нет побочных эффектов.  

---

## 🔹 **Пример НЕчистой функции**
```javascript
let total = 0;

function addToTotal(value) {
  total += value; // Мутирует внешнюю переменную
  return total;
}

console.log(addToTotal(5)); // 5
console.log(addToTotal(5)); // 10 (разные результаты при одинаковых входах!)
```
❌ **Почему нечистая?**  
- Зависит от внешнего состояния (`total`).  
- Мутирует внешнюю переменную.  

---

## 🔹 **Характеристики чистых функций**
1. **Предсказуемость**  
   Легко тестировать, так как результат детерминирован.

2. **Кешируемость**  
   Можно мемоизировать (сохранять результаты вызовов для оптимизации).

3. **Параллелизуемость**  
   Безопасны для многопоточного выполнения (хотя JS однопоточный).

4. **Ссылочная прозрачность**  
   Вызов функции можно заменить её результатом без изменения поведения программы.

---

## 🔹 **Примеры побочных эффектов, которые делают функцию нечистой**
1. **Мутация входных данных**  
   ```javascript
   function updateUser(user) {
     user.name = "Alice"; // Мутирует объект
     return user;
   }
   ```

2. **Работа с DOM**  
   ```javascript
   function changeColor() {
     document.body.style.background = "red"; // Побочный эффект
   }
   ```

3. **HTTP-запросы**  
   ```javascript
   async function fetchData() {
     const res = await fetch("/api"); // Зависит от внешнего сервера
     return res.json();
   }
   ```

4. **Глобальные переменные**  
   ```javascript
   let counter = 0;
   function increment() {
     counter++; // Изменяет глобальное состояние
   }
   ```

---

## 🔹 **Как сделать функцию чистой?**
### Пример исправления нечистой функции
**Было (нечистая):**
```javascript
function doubleValues(arr) {
  for (let i = 0; i < arr.length; i++) {
    arr[i] *= 2; // Мутирует исходный массив
  }
  return arr;
}
```

**Стало (чистая):**
```javascript
function doubleValues(arr) {
  return arr.map(item => item * 2); // Возвращает новый массив
}
```

---

## 🔹 **Практическое применение**
Чистые функции широко используются в:
- **Функциональном программировании**,
- **Redux (редьюсеры должны быть чистыми)**,
- **React (компоненты-функции без побочных эффектов в рендеринге)**.

---

## 🔹 **Итог: признаки чистой функции**
1. **Нет зависимостей от внешнего состояния** (только от аргументов).  
2. **Не изменяет внешние данные** (включая входные аргументы).  
3. **Всегда один результат для одинаковых входов**.  

```javascript
// Чистая функция
function square(x) {
  return x * x;
}

// Нечистая функция
function getRandom() {
  return Math.random(); // Разные результаты при одинаковых вызовах
}
```

Чистые функции делают код более предсказуемым, тестируемым и поддерживаемым! 🚀